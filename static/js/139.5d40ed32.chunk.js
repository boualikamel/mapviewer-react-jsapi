(this["webpackJsonpjsapi-create-react-app"]=this["webpackJsonpjsapi-create-react-app"]||[]).push([[139],{873:function(e,t,a){"use strict";a.r(t),a.d(t,"previewSymbol2D",(function(){return r}));var l=a(13),n=a(9),s=a(25),c=a(231),i=a(123),o=a(354);const u=document.createElement("canvas");function r(e,t){const a=null!=(null==t?void 0:t.size)?Object(s.e)(t.size):null,r=null!=(null==t?void 0:t.maxSize)?Object(s.e)(t.maxSize):null,m=null!=(null==t?void 0:t.opacity)?t.opacity:null,p=null!=(null==t?void 0:t.rotation)?t.rotation:null,h=Object(c.d)(e),d={shape:null,fill:null,stroke:h,offset:[0,0]};null!=h&&h.width&&(h.width=Math.min(h.width,80));const f=(null==h?void 0:h.width)||0;let b=null!=a&&(null==(null==t?void 0:t.scale)||(null==t?void 0:t.scale)),v=0,y=0;switch(e.type){case"simple-marker":{const t=e.style,l=Math.min(null!=a?a:Object(s.e)(e.size),r||120);switch(v=l,y=l,t){case"circle":d.shape={type:"circle",cx:0,cy:0,r:.5*l},b||(v+=f,y+=f);break;case"cross":d.shape={type:"path",path:[{command:"M",values:[0,.5*y]},{command:"L",values:[v,.5*y]},{command:"M",values:[.5*v,0]},{command:"L",values:[.5*v,y]}]};break;case"diamond":d.shape={type:"path",path:[{command:"M",values:[0,.5*y]},{command:"L",values:[.5*v,0]},{command:"L",values:[v,.5*y]},{command:"L",values:[.5*v,y]},{command:"Z",values:[]}]},b||(v+=f,y+=f);break;case"square":d.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[v,0]},{command:"L",values:[v,y]},{command:"L",values:[0,y]},{command:"Z",values:[]}]},b||(v+=f,y+=f);break;case"triangle":d.shape={type:"path",path:[{command:"M",values:[.5*v,0]},{command:"L",values:[v,y]},{command:"L",values:[0,y]},{command:"Z",values:[]}]},b||(v+=f,y+=f);break;case"x":d.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[v,y]},{command:"M",values:[v,0]},{command:"L",values:[0,y]}]};break;case"path":d.shape={type:"path",path:e.path||""},b||(v+=f,y+=f),b=!0}break}case"simple-line":{const e=Math.min(null!=a?a:f,r||80),t=e>22?2*e:40;h.width=e,v=t,y=e,d.shape={type:"path",path:[{command:"M",values:[0,y]},{command:"L",values:[v,y]}]};break}case"picture-fill":case"simple-fill":v=Math.min(null!=a?a:22,r||120)+f,y=v,b=!0,d.shape="object"==typeof(null==t?void 0:t.symbolConfig)&&null!=t&&t.symbolConfig.isSquareFill?i.l.squareFill[0]:i.l.fill[0];break;case"picture-marker":{let t=Object(s.e)(e.width),l=Object(s.e)(e.height);const n=Math.max(t,l),c=t/l;t=c<=1?Math.ceil(n*c):n,l=c<=1?n:Math.ceil(n/c),v=Math.min(null!=a?a:t,r||120),y=Math.min(null!=a?a:l,r||120),d.shape={type:"image",x:-Math.round(v/2),y:-Math.round(y/2),width:v,height:y,src:e.url||""};break}case"text":{const t=e,l=t.text||"Aa",n=t.font,c=Math.min(null!=a?a:Object(s.e)(n.size),r||120),i=function(e,t){const a=u.getContext("2d"),l=[];return t&&(t.weight&&l.push(t.weight),t.size&&l.push(t.size+"px"),t.family&&l.push(t.family)),a.font=l.join(" "),a.measureText(e).width}(l,{weight:n.weight,size:c,family:n.family}),o=/[\uE600-\uE6FF]/.test(l);v=o?c:i,y=c;let m=.25*function(e){if(0===e.length)return 0;if(e.length>2){const t=Object(s.f)(1),a=parseFloat(e);switch(e.slice(-2)){case"px":return a;case"pt":return a*t;case"in":return 72*a*t;case"pc":return 12*a*t;case"mm":return 2.8346456692913384*a*t;case"cm":return 28.346456692913385*a*t}}return parseFloat(e)}((n?c:0).toString());o&&(m+=5),d.shape={type:"text",text:l,x:0,y:m,align:"middle",decoration:n&&n.decoration,rotated:t.rotated,kerning:t.kerning},d.font=n&&{size:c,style:n.style,decoration:n.decoration,weight:n.weight,family:n.family};break}}if(!d.shape)return Object(n.t)(new l.a("symbolPreview: renderPreviewHTML2D","symbol not supported."));const w=Object(c.b)(e),M=w,g=e.color;let j=null;return M&&"pattern"===M.type&&g&&"picture-fill"!==e.type?j=Object(c.c)(M.src,g.toCss(!0)).then((e=>(M.src=e,d.fill=M,d))):(d.fill=w,j=Object(n.u)(d)),j.then((e=>{const a=[[e]];if("object"==typeof(null==t?void 0:t.symbolConfig)&&null!=t&&t.symbolConfig.applyColorModulation){const t=.6*v;a.unshift([{...e,offset:[-t,0],fill:Object(i.a)(w,-.3)}]),a.push([{...e,offset:[t,0],fill:Object(i.a)(w,.3)}]),v+=2*t}return Object(o.a)(a,[v,y],{node:t&&t.node,scale:b,opacity:m,rotation:p})}))}}}]);