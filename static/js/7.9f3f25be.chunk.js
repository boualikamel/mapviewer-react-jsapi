(this["webpackJsonptesting-ant-cra"]=this["webpackJsonptesting-ant-cra"]||[]).push([[7,154],{600:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i}));var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{};function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function a(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}}).call(this,r(441))},609:function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return j})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return _})),r.d(t,"g",(function(){return I}));var n=r(27),i=r(82);var a=function(e,t,r){return[t,r]},s=function(e,t,r){return[t,r,e[2]]},u=function(e,t,r){return[t,r,e[2],e[3]]};function c(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function o(e,t){var r=e.scale,n=e.translate;return Math.round((t-n[0])/r[0])}function l(e,t){var r=e.scale,n=e.translate;return Math.round((n[1]-t)/r[1])}function f(e,t,r){for(var n,i,a,s,u=[],c=0;c<r.length;c++){var f=r[c];c>0?(a=o(e,f[0]),s=l(e,f[1]),a===n&&s===i||(u.push(t(f,a-n,s-i)),n=a,i=s)):(n=o(e,f[0]),i=l(e,f[1]),u.push(t(f,n,i)))}return u.length>0?u:null}function h(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function p(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function d(e,t,r){var i=new Array(r.length);if(!r.length)return i;var a=Object(n.a)(e.scale,2),s=a[0],u=a[1],c=h(e,r[0][0]),o=p(e,r[0][1]);i[0]=t(r[0],c,o);for(var l=1;l<r.length;l++){var f=r[l];c+=f[0]*s,o-=f[1]*u,i[l]=t(f,c,o)}return i}function m(e,t,r){for(var n=new Array(r.length),i=0;i<r.length;i++)n[i]=d(e,t,r[i]);return n}function v(e,t,r,n,i){return t.points=function(e,t,r,n){return f(e,r?n?u:s:n?s:a,t)}(e,r.points,n,i),t}function y(e,t,r,n,i){return t.x=o(e,r.x),t.y=l(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m)),t}function b(e,t,r,n,i){var c=function(e,t,r,n){for(var i=[],c=r?n?u:s:n?s:a,o=0;o<t.length;o++){var l=f(e,c,t[o]);l&&l.length>=3&&i.push(l)}return i.length?i:null}(e,r.rings,n,i);return c?(t.rings=c,t):null}function x(e,t,r,n,i){var c=function(e,t,r,n){for(var i=[],c=r?n?u:s:n?s:a,o=0;o<t.length;o++){var l=f(e,c,t[o]);l&&l.length>=2&&i.push(l)}return i.length?i:null}(e,r.paths,n,i);return c?(t.paths=c,t):null}function g(e,t){return e&&t?Object(i.f)(t)?y(e,{},t,!1,!1):Object(i.h)(t)?x(e,{},t,!1,!1):Object(i.g)(t)?b(e,{},t,!1,!1):Object(i.e)(t)?v(e,{},t,!1,!1):Object(i.d)(t)?(s=!1,u=!1,(n={}).xmin=o(r=e,(a=t).xmin),n.ymin=l(r,a.ymin),n.xmax=o(r,a.xmax),n.ymax=l(r,a.ymax),n!==a&&(s&&(n.zmin=a.zmin,n.zmax=a.zmax),u&&(n.mmin=a.mmin,n.mmax=a.mmax)),n):null:null;var r,n,a,s,u}function j(e,t,r,n,i){return t.points=function(e,t,r,n){return d(e,r?n?u:s:n?s:a,t)}(e,r.points,n,i),t}function O(e,t,r,n,i){return t.x=h(e,r.x),t.y=p(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m)),t}function _(e,t,r,n,i){return t.rings=function(e,t,r,n){return m(e,r?n?u:s:n?s:a,t)}(e,r.rings,n,i),t}function I(e,t,r,n,i){return t.paths=function(e,t,r,n){return m(e,r?n?u:s:n?s:a,t)}(e,r.paths,n,i),t}},619:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return O})),r.d(t,"c",(function(){return I}));var n=r(8),i=r.n(n),a=r(4),s=r(5),u=r(14),c=r(15),o=r(27),l=r(267),f=r(644),h=r(45),p=r(57),d=[0,0];function m(e,t){if(!t)return null;if("x"in t){var r,n,i={x:0,y:0};return r=e(t.x,t.y,d),n=Object(o.a)(r,2),i.x=n[0],i.y=n[1],null!=t.z&&(i.z=t.z),null!=t.m&&(i.m=t.m),i}if("xmin"in t){var a,s,u,c,l={xmin:0,ymin:0,xmax:0,ymax:0};return a=e(t.xmin,t.ymin,d),s=Object(o.a)(a,2),l.xmin=s[0],l.ymin=s[1],u=e(t.xmax,t.ymax,d),c=Object(o.a)(u,2),l.xmax=c[0],l.ymax=c[1],t.hasZ&&(l.zmin=t.zmin,l.zmax=t.zmax,l.hasZ=!0),t.hasM&&(l.mmin=t.mmin,l.mmax=t.mmax,l.hasM=!0),l}return"rings"in t?{rings:v(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:v(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:y(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function v(e,t){var r,n=[],i=Object(c.a)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(y(a,t))}}catch(s){i.e(s)}finally{i.f()}return n}function y(e,t){var r,n=[],i=Object(c.a)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,s=t(a[0],a[1],[0,0]);n.push(s),a.length>2&&s.push(a[2]),a.length>3&&s.push(a[3])}}catch(u){i.e(u)}finally{i.f()}return n}function b(e,t){return x.apply(this,arguments)}function x(){return(x=Object(u.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return n=Array.isArray(t)?t.map((function(e){var t;return null==(t=e.geometry)?void 0:t.spatialReference})):[t],e.next=5,Object(l.f)(n.map((function(e){return{source:e,dest:r}})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g=m.bind(null,p.c),j=m.bind(null,p.g);function O(e,t,r){return e?(r||(r=t,t=e.spatialReference),Object(h.j)(t)&&Object(h.j)(r)&&!Object(h.c)(t,r)?Object(p.a)(t,r)?Object(h.n)(r)?g(e):j(e):Object(l.m)(f.a,[e],t,r,null)[0]:e):e}var _=new(function(){function e(){Object(a.a)(this,e),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return Object(s.a)(e,[{key:"push",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r,n){var a,s=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.length&&r&&n&&!Object(h.c)(r,n)){e.next=2;break}return e.abrupt("return",t);case 2:return a={geometries:t,inSpatialReference:r,outSpatialReference:n,resolve:null},e.abrupt("return",(this._jobs.push(a),new Promise((function(e){a.resolve=e,null===s._timer&&(s._timer=setTimeout(s._process,10))}))));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,r=e.inSpatialReference,n=e.outSpatialReference,i=e.resolve;Object(p.a)(r,n)?Object(h.n)(n)?i(t.map(g)):i(t.map(j)):i(Object(l.m)(f.a,t,r,n,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),e}());function I(e,t,r){return _.push(e,t,r)}},625:function(e,t,r){"use strict";r.d(t,"a",(function(){return w})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return I})),r.d(t,"f",(function(){return s})),r.d(t,"g",(function(){return c})),r.d(t,"h",(function(){return o})),r.d(t,"i",(function(){return u})),r.d(t,"j",(function(){return j})),r.d(t,"k",(function(){return a})),r.d(t,"l",(function(){return _})),r.d(t,"m",(function(){return m})),r.d(t,"n",(function(){return v})),r.d(t,"o",(function(){return x})),r.d(t,"p",(function(){return b})),r.d(t,"q",(function(){return y})),r.d(t,"r",(function(){return d}));var n=r(10);r(53),r(142);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S;return[e[0],e[1],e[2],e[3],e[4],e[5]]}function a(e,t,r,n,a,s){var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:i();return u[0]=e,u[1]=t,u[2]=r,u[3]=n,u[4]=a,u[5]=s,u}function s(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function u(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function c(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length/3,i=e[0],a=e[1],s=e[2],u=e[3],c=e[4],o=e[5],l=0;l<n;l++)i=Math.min(i,t[r+3*l]),a=Math.min(a,t[r+3*l+1]),s=Math.min(s,t[r+3*l+2]),u=Math.max(u,t[r+3*l]),c=Math.max(c,t[r+3*l+1]),o=Math.max(o,t[r+3*l+2]);e[0]=i,e[1]=a,e[2]=s,e[3]=u,e[4]=c,e[5]=o}function o(e,t,r){var n=t.length,i=e[0],a=e[1],s=e[2],u=e[3],c=e[4],o=e[5];if(r)for(var l=0;l<n;l++){var f=t[l];i=Math.min(i,f[0]),a=Math.min(a,f[1]),s=Math.min(s,f[2]),u=Math.max(u,f[0]),c=Math.max(c,f[1]),o=Math.max(o,f[2])}else for(var h=0;h<n;h++){var p=t[h];i=Math.min(i,p[0]),a=Math.min(a,p[1]),u=Math.max(u,p[0]),c=Math.max(c,p[1])}e[0]=i,e[1]=a,e[2]=s,e[3]=u,e[4]=c,e[5]=o}function l(e){return e[0]>=e[3]?0:e[3]-e[0]}function f(e){return e[1]>=e[4]?0:e[4]-e[1]}function h(e){return e[2]>=e[5]?0:e[5]-e[2]}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=e[0]+l(e)/2,t[1]=e[1]+f(e)/2,t[2]=e[2]+h(e)/2,t}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=l(e),t[1]=f(e),t[2]=h(e),t}function m(e){return Math.max(l(e),h(e),f(e))}function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=e[0]+l(e)/2,i=e[1]+f(e)/2,a=e[2]+h(e)/2;return r[0]=n+(e[0]-n)*t,r[1]=i+(e[1]-i)*t,r[2]=a+(e[2]-a)*t,r[3]=n+(e[3]-n)*t,r[4]=i+(e[4]-i)*t,r[5]=a+(e[5]-a)*t,r}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r}function b(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e}function x(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function g(e){return e?x(e,w):i(w)}function j(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function O(e){return 6===e.length}function _(e){return 0===l(e)&&0===f(e)&&0===h(e)}function I(e,t,r){if(Object(n.j)(e)||Object(n.j)(t))return e===t;if(!O(e)||!O(t))return!1;if(r){for(var i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1}else for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}var w=[1/0,1/0,1/0,-1/0,-1/0,-1/0],S=[0,0,0,0,0,0];i()},635:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(15);function i(e,t){return e?t?4:3:t?3:2}function a(e,t,r,a,c){if(!t||!t.lengths.length)return null;var o="upperLeft"===(null==c?void 0:c.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);var l,f=e.coords,h=[],p=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],d=t.lengths,m=t.coords,v=i(r,a),y=0,b=Object(n.a)(d);try{for(b.s();!(l=b.n()).done;){var x=l.value,g=s(p,m,y,x,r,a,o);g&&h.push(g),y+=x*v}}catch(_){b.e(_)}finally{b.f()}if(h.sort((function(e,t){var n=o*e[2]-o*t[2];return 0===n&&r&&(n=e[4]-t[4]),n})),h.length){var j=6*h[0][2];f[0]=h[0][0]/j,f[1]=h[0][1]/j,r&&(j=6*h[0][4],f[2]=0!==j?h[0][3]/j:0),(f[0]<p[0]||f[0]>p[1]||f[1]<p[2]||f[1]>p[3]||r&&(f[2]<p[4]||f[2]>p[5]))&&(f.length=0)}if(!f.length){var O=t.lengths[0]?u(m,0,d[0],r,a):null;if(!O)return null;f[0]=O[0],f[1]=O[1],r&&O.length>2&&(f[2]=O[2])}return e}function s(e,t,r,n,a,s){for(var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=i(a,s),o=r,l=r+c,f=0,h=0,p=0,d=0,m=0,v=0,y=n-1;v<y;v++,o+=c,l+=c){var b=t[o],x=t[o+1],g=t[o+2],j=t[l],O=t[l+1],_=t[l+2],I=b*O-j*x;d+=I,f+=(b+j)*I,h+=(x+O)*I,a&&(p+=(g+_)*(I=b*_-j*g),m+=I),b<e[0]&&(e[0]=b),b>e[1]&&(e[1]=b),x<e[2]&&(e[2]=x),x>e[3]&&(e[3]=x),a&&(g<e[4]&&(e[4]=g),g>e[5]&&(e[5]=g))}if(d*u>0&&(d*=-1),m*u>0&&(m*=-1),!d)return null;var w=[f,h,.5*d];return a&&(w[3]=p,w[4]=.5*m),w}function u(e,t,r,n,a){for(var s=i(n,a),u=t,h=t+s,p=0,d=0,m=0,v=0,y=0,b=r-1;y<b;y++,u+=s,h+=s){var x=e[u],g=e[u+1],j=e[u+2],O=e[h],_=e[h+1],I=e[h+2],w=n?o(x,g,j,O,_,I):c(x,g,O,_);if(w)if(p+=w,n){var S=f(x,g,j,O,_,I);d+=w*S[0],m+=w*S[1],v+=w*S[2]}else{var k=l(x,g,O,_);d+=w*k[0],m+=w*k[1]}}return p>0?n?[d/p,m/p,v/p]:[d/p,m/p]:r>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function c(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function o(e,t,r,n,i,a){var s=n-e,u=i-t,c=a-r;return Math.sqrt(s*s+u*u+c*c)}function l(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function f(e,t,r,n,i,a){return[e+.5*(n-e),t+.5*(i-t),r+.5*(a-r)]}},641:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,i,a={exports:{}};n=a,void 0!==(i=function(){function e(r,n,i,a,s){for(;a>i;){if(a-i>600){var u=a-i+1,c=n-i+1,o=Math.log(u),l=.5*Math.exp(2*o/3),f=.5*Math.sqrt(o*l*(u-l)/u)*(c-u/2<0?-1:1);e(r,n,Math.max(i,Math.floor(n-c*l/u+f)),Math.min(a,Math.floor(n+(u-c)*l/u+f)),s)}var h=r[n],p=i,d=a;for(t(r,i,n),s(r[a],h)>0&&t(r,i,a);p<d;){for(t(r,p,d),p++,d--;s(r[p],h)<0;)p++;for(;s(r[d],h)>0;)d--}0===s(r[i],h)?t(r,i,d):t(r,++d,a),d<=n&&(i=d+1),n<=d&&(a=d-1)}}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}return function(t,n,i,a,s){e(t,n,i||0,a||t.length-1,s||r)}}())&&(n.exports=i);var s=a.exports},644:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(4),i={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){var n=new a(e.getPointX(t),e.getPointY(t),r),i=e.hasZ(t),s=e.hasM(t);return i&&(n.z=e.getPointZ(t)),s&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new s(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new u(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new c(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){var n=e.hasZ(t),i=e.hasM(t),a=new o(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){var s=e.getZExtent(t);a.zmin=s.vmin,a.zmax=s.vmax}if(i){var u=e.getMExtent(t);a.mmin=u.vmin,a.mmax=u.vmax}return a}};var a=function e(t,r,i){Object(n.a)(this,e),this.x=t,this.y=r,this.spatialReference=i,this.z=void 0,this.m=void 0};var s=function e(t,r,i,a){Object(n.a)(this,e),this.rings=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),a&&(this.hasM=a)};var u=function e(t,r,i,a){Object(n.a)(this,e),this.paths=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),a&&(this.hasM=a)};var c=function e(t,r,i,a){Object(n.a)(this,e),this.points=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),a&&(this.hasM=a)};var o=function e(t,r,i,a,s){Object(n.a)(this,e),this.xmin=t,this.ymin=r,this.xmax=i,this.ymax=a,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}},699:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},771:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return A})),r.d(t,"c",(function(){return _})),r.d(t,"d",(function(){return I})),r.d(t,"e",(function(){return S})),r.d(t,"f",(function(){return O}));var n=r(8),i=r.n(n),a=r(14),s=r(42),u=r(10),c=r(56),o=r(370),l=r(82),f=r(367),h=r(45),p=(r(635),r(439)),d=r(154),m=r(619),v=new s.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),y=Object.freeze({}),b=new d.a,x=new d.a,g=new d.a,j={esriGeometryPoint:p.m,esriGeometryPolyline:p.o,esriGeometryPolygon:p.n,esriGeometryMultipoint:p.l};function O(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.hasZ,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.hasM,a=e.hasZ&&n,s=e.hasM&&i;if(r){var u=Object(p.u)(g,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,i);return Object(p.m)(u,a,s)}return Object(p.m)(t,a,s)}function _(e,t,r,n,i,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:r,c=t&&s,o=r&&u,l=n?"coords"in n?n:n.geometry:null;if(!l)return null;if(i){var f=Object(p.q)(x,l,t,r,e,i,s,u);return a&&(f=Object(p.u)(g,f,c,o,e,a)),j[e](f,c,o)}if(a){var h=Object(p.u)(g,l,t,r,e,a,s,u);return j[e](h,c,o)}return Object(p.x)(b,l,t,r,s,u),j[e](b,c,o)}function I(e,t,r){return w.apply(this,arguments)}function w(){return(w=Object(a.a)(i.a.mark((function e(t,r,n){var a,s,u,c,o,l,f,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.outFields,s=t.orderByFields,u=t.groupByFieldsForStatistics,c=t.outStatistics,a)for(o=0;o<a.length;o++)a[o]=a[o].trim();if(s)for(l=0;l<s.length;l++)s[l]=s[l].trim();if(u)for(f=0;f<u.length;f++)u[f]=u[f].trim();if(c)for(h=0;h<c.length;h++)c[h].onStatisticField&&(c[h].onStatisticField=c[h].onStatisticField.trim());return e.abrupt("return",(t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),S(t,r,n)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,r){return k.apply(this,arguments)}function k(){return(k=Object(a.a)(i.a.mark((function e(t,r,n){var a,s,c,h,p,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(a=t.where,t.where=a=a&&a.trim(),(!a||/^1 *= *1$/.test(a)||r&&r===a)&&(t.where=null),t.geometry){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,F(t);case 7:return s=e.sent,t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel&&(c=t.geometry.spatialReference,(s=Object(o.a)(s)).spatialReference=c),t.geometry=s,e.next=12,Object(m.a)(s.spatialReference,n);case 12:return e.next=14,Object(f.a)(Object(l.a)(s));case 14:if(h=e.sent[0],!Object(u.j)(h)){e.next=17;break}throw y;case 17:return p=h.toJSON(),e.next=20,Object(m.b)(p,p.spatialReference,n);case 20:if(d=e.sent){e.next=23;break}throw y;case 23:return e.abrupt("return",(d.spatialReference=n,t.geometry=d,t));case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return R.apply(this,arguments)}function R(){return(R=Object(a.a)(i.a.mark((function e(t){var r,n,a,s,u,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.geometry,n=t.distance,a=t.units,null!=n&&!("vertexAttributes"in r)){e.next=3;break}return e.abrupt("return",r);case 3:if(s=r.spatialReference,u=a?v.fromJSON(a):Object(c.h)(s),!s||!Object(h.g)(s)&&!Object(h.n)(s)){e.next=9;break}e.t0=r,e.next=12;break;case 9:return e.next=11,Object(m.a)(s,h.a).then((function(){return Object(m.b)(r,h.a)}));case 11:e.t0=e.sent;case 12:return o=e.t0,e.next=15,M();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t1)(o.spatialReference,o,n,u));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return T.apply(this,arguments)}function T(){return(T=Object(a.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(5),r.e(21)]).then(r.bind(null,827));case 2:return e.abrupt("return",e.sent.geodesicBuffer);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return e&&N in e?JSON.parse(JSON.stringify(e,Q)):e}var N="_geVersion",Q=function(e,t){return e!==N?t:void 0}},791:function(e,t,r){"use strict";var n=r(11),i=r(15),a=r(8),s=r.n(a),u=r(14),c=r(5),o=r(4),l=r(22),f=r(23),h=r(10),p=r(394),d=r(56),m=r(625),v=r(142),y=r(368),b=r(82),x=r(367),g=r(45),j=r(35),O=r(490),_=r(569),I=new(function(){function e(t,r){Object(o.a)(this,e),this._cache=new O.a(t),this._invalidCache=new O.a(r)}return Object(c.a)(e,[{key:"get",value:function(e,t){var r="".concat(t.uid,":").concat(e),n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{var i=_.WhereClause.create(e,t);return this._cache.put(r,i),i}catch(a){return this._invalidCache.put(r,null),null}}}]),e}())(50,500),w="feature-store:unsupported-query",S=" as ",k=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function F(e,t,r){if(!t)return!0;var n=I.get(t,e);if(!n)throw new l.a(w,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new l.a(w,"having does not contain a valid aggregate function",{having:t});var i=n.fieldNames;if(M(e,i,"having contains missing fields"),!n.getExpressions().every((function(t){var n=t.aggregateType,i=t.field,a=e.has(i)&&e.get(i).name;return r.some((function(t){var r=t.onStatisticField,i=t.statisticType;return(e.has(r)&&e.get(r).name)===a&&i.toLowerCase().trim()===n}))})))throw new l.a(w,"expressions in having should also exist in outStatistics",{having:t});return!0}function R(e,t){return e?I.get(e,t):null}function M(e,t,r){var n,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=[],u=Object(i.a)(t);try{for(u.s();!(n=u.n()).done;){var c=n.value;if("*"!==c&&!e.has(c))if(a){var o=T(c);try{var f=R(o,e);if(!f)throw new l.a(w,"invalid SQL expression",{where:o});if(!f.isStandardized)throw new l.a(w,"expression is not standard",{clause:f});M(e,f.fieldNames,"expression contains missing fields")}catch(p){var h=p&&p.details;if(h&&(h.clause||h.where))throw p;h&&h.missingFields?s.push.apply(s,Object(j.a)(h.missingFields)):s.push(c)}}else s.push(c)}}catch(d){u.e(d)}finally{u.f()}if(s.length)throw new l.a(w,r,{missingFields:s})}function T(e){return e.split(S)[0]}function A(e,t){var r=t.get(e);return!!r&&!k.has(r.type)}var N=r(619),Q=r(699),P=r(609),E=r(439),z=r(842),V=function(){function e(t,r,n){Object(o.a)(this,e),this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=n,this.featureAdapter=r;var a=t.outFields;if(a&&-1===a.indexOf("*")){this.outFields=a;var s,u=0,c=Object(i.a)(a);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=T(l),h=this.fieldsIndex.get(f),p=h?null:R(f,n),d=h?h.name:l.split(S)[1]||"FIELD_EXP_"+u++;this._fieldDataCache.set(l,{alias:d,clause:p})}}catch(m){c.e(m)}finally{c.f()}}}return Object(c.a)(e,[{key:"countDistinctValues",value:function(e){var t=this;return this.returnDistinctValues?(e.forEach((function(e){return t.getAttributes(e)})),this._returnDistinctMap.size):e.length}},{key:"getAttributes",value:function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}},{key:"getFieldValue",value:function(e,t,r){var n=r?r.name:t,i=null;return this._fieldDataCache.has(n)?i=this._fieldDataCache.get(n).clause:r||(i=R(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:i})),r?this.featureAdapter.getAttribute(e,n):i.calculateValue(e,this.featureAdapter)}},{key:"getNormalizedValue",value:function(e,t){var r=t.normalizationType,n=t.normalizationTotal,i=this.getFieldValue(e,t.field,t.fieldInfo);if(r&&Number.isFinite(i)){var a=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);i=Object(z.c)(i,r,a,n)}return i}},{key:"getExpressionValue",value:function(e,t,r){var n={attributes:this.featureAdapter.getAttributes(e)},i=r.createExecContext(n,t.viewInfo);return r.executeFunction(t.compiledFunc,i)}},{key:"validateItem",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:R(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}},{key:"validateItems",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:R(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}},{key:"_processAttributesForOutFields",value:function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);var r,n={},a=Object(i.a)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value,u=this._fieldDataCache.get(s),c=u.alias,o=u.clause;n[c]=o?o.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,c)}}catch(l){a.e(l)}finally{a.f()}return n}},{key:"_processAttributesForDistinctValues",value:function(e){if(Object(h.j)(e)||!this.returnDistinctValues)return e;var t=this.outFields,r=[];if(t){var n,a=Object(i.a)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value,u=this._fieldDataCache.get(s).alias;r.push(e[u])}}catch(f){a.e(f)}finally{a.f()}}else for(var c in e)r.push(e[c]);var o="".concat((t||["*"]).join(","),"=").concat(r.join(",")),l=this._returnDistinctMap.get(o)||0;return this._returnDistinctMap.set(o,++l),l>1?null:e}}]),e}(),C=r(843),G=r(771),q=r(70),D=r(136);function Z(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function B(e,t,r){return(r?e>t:e<t)?-1:(r?e<t:e>t)?1:0}function Y(e,t,r){return r?t-e:e-t}function L(e,t,r,n){if(r&&"esriFieldTypeDate"===r.type){var i=new Date(e).getTime(),a=new Date(t).getTime();if(!isNaN(i)&&!isNaN(a))return Y(i,a,n)}if("number"==typeof e&&"number"==typeof t)return Y(e,t,n);if("string"==typeof e&&"string"==typeof t){var s=e.toUpperCase(),u=t.toUpperCase();return!r||"esriFieldTypeGUID"!==r.type&&"esriFieldTypeGlobalID"!==r.type?B(s,u,n):B(Z(s),Z(u),n)}return n?1:-1}function U(e,t,r,n,i,a){var s=i-r,u=a-n,c=s*s+u*u,o=(e-r)*s+(t-n)*u,l=Math.min(1,Math.max(0,o/c));return{x:r+s*l,y:n+u*l}}var J=function(){function e(t,r,n){Object(o.a)(this,e),this.items=t,this.queryGeometry=r,this.definitionExpression=n.definitionExpression,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.fieldsIndex=n.fieldsIndex,this.timeInfo=n.timeInfo,this.featureAdapter=n.featureAdapter,this.aggregateAdapter=n.aggregateAdapter}return Object(c.a)(e,[{key:"size",get:function(){return this.items.length}},{key:"createQueryResponseForCount",value:function(e){var t=new V(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);var r=e.groupByFieldsForStatistics,n=e.having;if(!(null==r?void 0:r.length))return 1;var a,s=new Map,u=new Map,c=new Set,o=e.outStatistics,l=Object(i.a)(o);try{for(l.s();!(a=l.n()).done;){var f=a.value,h="exceedslimit"!==f.statisticType?f.onStatisticField:void 0;if(!u.has(h)){var p,d=[],m=Object(i.a)(r);try{for(m.s();!(p=m.n()).done;){var v=p.value,y=this._getAttributeValues(t,v,s);d.push(y)}}catch(I){m.e(I)}finally{m.f()}u.set(h,this._calculateUniqueValues(d))}var b=u.get(h);for(var x in b){var g=b[x],j=g.data,O=g.items,_=j.join(",");n&&!t.validateItems(O,n)||c.add(_)}}}catch(I){l.e(I)}finally{l.f()}return c.size}},{key:"createQueryResponse",value:function(e){var t;return t=e.outStatistics?e.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(Object(g.j)(e.outSR)&&!Object(g.c)(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=Object(G.b)(Object(n.a)({spatialReference:e.outSR},Object(N.b)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):t.queryGeometry=Object(G.b)(Object(n.a)({spatialReference:e.outSR},this.queryGeometry))),t}},{key:"createSnappingResponse",value:function(e,t){var r,n=this.featureAdapter,a=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),s=e.point,u=s.x,c=s.y,o="number"==typeof e.distance?e.distance:e.distance.x,l="number"==typeof e.distance?e.distance:e.distance.y,f={candidates:[]},h="esriGeometryPolygon"===this.geometryType,p=this.getPointCreator(e.point,this.spatialReference,t),d=Object(i.a)(this.items);try{for(d.s();!(r=d.n()).done;){var m=r.value,v=n.getGeometry(m);if(v){var y=v.coords,b=v.lengths;if(1&e.types)for(var x=0,g=0;g<b.length;g++)for(var j=b[g],O=0;O<j;O++,x+=a){var _=y[x],I=y[x+1];if(O!==j-1){var w=y[x+a],S=y[x+a+1],k=U(u,c,_,I,w,S),F=k.x,R=k.y,M=(u-F)/o,T=(c-R)/l,A=M*M+T*T;A<=1&&f.candidates.push({type:"edge",objectId:n.getObjectId(m),distance:Math.sqrt(A),target:p(F,R),start:p(_,I),end:p(w,S)})}}if(2&e.types)for(var N=h?y.length-a:y.length,Q=0;Q<N;Q+=a){var P=y[Q],E=y[Q+1],z=(u-P)/o,V=(c-E)/l,C=z*z+V*V;C<=1&&f.candidates.push({type:"vertex",objectId:n.getObjectId(m),distance:Math.sqrt(C),target:p(P,E)})}}}}catch(G){d.e(G)}finally{d.f()}return f.candidates.sort((function(e,t){return e.distance-t.distance})),f}},{key:"getPointCreator",value:function(e,t,r){var n=Object(h.k)(r)&&!Object(g.c)(t,r)?function(e){return Object(N.b)(e,t,r)}:function(e){return e};return null!=e.z&&null!=e.m?function(t,r){return n({x:t,y:r,z:e.z,m:e.m})}:null!=e.z?function(t,r){return n({x:t,y:r,z:e.z})}:null!=e.m?function(t,r){return n({x:t,y:r,m:e.m})}:function(e,t){return n({x:e,y:t})}}},{key:"executeAttributesQuery",value:function(t){var r=R(t.where,this.fieldsIndex);if(!r)return Promise.resolve(this);if(r.isStandardized){var n,a=0,s=[],u=Object(i.a)(this.items);try{for(u.s();!(n=u.n()).done;){var c=n.value;r.testFeature(c,this.featureAdapter)&&(s[a++]=c)}}catch(l){u.e(l)}finally{u.f()}var o=new e(s,this.queryGeometry,this);return o.definitionExpression=t.where,Promise.resolve(o)}return Promise.reject(new TypeError("Where clause is not standardized"))}},{key:"executeAggregateIdsQuery",value:function(t){if(!t.aggregateIds||!t.aggregateIds.length||Object(h.j)(this.aggregateAdapter))return Promise.resolve(this);var r,n=new Set,a=Object(i.a)(t.aggregateIds);try{for(a.s();!(r=a.n()).done;){var s=r.value;this.aggregateAdapter.getFeatureObjectIds(s).forEach((function(e){return n.add(e)}))}}catch(c){a.e(c)}finally{a.f()}var u=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return n.has(u(e))})),this.queryGeometry,this))}},{key:"executeObjectIdsQuery",value:function(t){if(!t.objectIds||!t.objectIds.length)return Promise.resolve(this);var r=new Set(t.objectIds),n=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return r.has(n(e))})),this.queryGeometry,this))}},{key:"executeTimeQuery",value:function(t){var r=Object(C.b)(this.timeInfo,t.timeExtent,this.featureAdapter);if(!Object(h.k)(r))return Promise.resolve(this);var n=this.items.filter(r);return Promise.resolve(new e(n,this.queryGeometry,this))}},{key:"filterLatest",value:function(){var t,r=this.timeInfo,n=r.trackIdField,a=r.startTimeField,s=r.endTimeField||a,u=new Map,c=this.featureAdapter.getAttribute,o=Object(i.a)(this.items);try{for(o.s();!(t=o.n()).done;){var l=t.value,f=c(l,n),h=c(l,s),p=u.get(f);(!p||h>c(p,s))&&u.set(f,l)}}catch(m){o.e(m)}finally{o.f()}var d=Array.from(u.values());return Promise.resolve(new e(d,this.queryGeometry,this))}},{key:"project",value:function(){var t=Object(u.a)(s.a.mark((function t(r){var n,i,a=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&!Object(g.c)(this.spatialReference,r)){t.next=2;break}return t.abrupt("return",this);case 2:return n=this.featureAdapter,t.next=5,Object(N.c)(this.items.map((function(e){return Object(G.c)(a.geometryType,a.hasZ,a.hasM,n.getGeometry(e))})),this.spatialReference,r);case 5:return i=t.sent.map((function(e,t){return n.cloneWithGeometry(a.items[t],Object(E.d)(e,a.hasZ,a.hasM))})),t.abrupt("return",new e(i,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:r,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter}));case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"createSummaryStatisticsResponse",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){var n,i,a,u,c,o,l,f,h,p,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.field,i=r.normalizationField,a=r.normalizationType,u=r.normalizationTotal,c=r.minValue,o=r.maxValue,l=new V(t,this.featureAdapter,this.fieldsIndex),f=this.fieldsIndex.isDateField(n),!r.valueExpression){e.next=14;break}return e.next=11,this._getAttributeExpressionValues(l,r.valueExpression,r.viewInfoParams);case 11:e.t0=e.sent,e.next=15;break;case 14:e.t0=this._getAttributeNormalizedValues(l,{field:n,normalizationField:i,normalizationType:a,normalizationTotal:u});case 15:return h=e.t0,p=Object(z.d)({normalizationType:a,normalizationField:i,minValue:c,maxValue:o}),d=Object(q.q)(this.fieldsIndex.get(n))?Object(z.b)({values:h,supportsNullCount:p}):Object(z.a)({values:h,minValue:c,maxValue:o,useSampleStdDev:!a,supportsNullCount:p}),e.abrupt("return",Object(z.e)(d,f));case 19:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_sortFeatures",value:function(e,t,r){var n=this;if(e.length>1&&t&&t.length){var a,s=Object(i.a)(t.reverse());try{var u=function(){var t=a.value.split(" "),i=t[0],s=n.fieldsIndex.get(i),u=t[1]&&"desc"===t[1].toLowerCase();e.sort((function(e,t){return L(r(e,i,s),r(t,i,s),s,u)}))};for(s.s();!(a=s.n()).done;)u()}catch(c){s.e(c)}finally{s.f()}}}},{key:"_createFeatureQueryResponse",value:function(e){var t=this,r=this.items,n=this.geometryType,i=this.hasM,a=this.hasZ,s=this.objectIdField,u=this.spatialReference,c=e.outFields,o=e.outSR,l=e.quantizationParameters,f=e.resultRecordCount,h=e.resultOffset,p=e.returnZ,d=e.returnM,m=null!=f&&r.length>(h||0)+f,v=c&&(c.indexOf("*")>-1?Object(j.a)(this.fieldsIndex.fields):c.map((function(e){return t.fieldsIndex.get(e)})));return{exceededTransferLimit:m,features:this._createFeatures(e,r),fields:v,geometryType:n,hasM:i&&d,hasZ:a&&p,objectIdFieldName:s,spatialReference:Object(G.b)(o||u),transform:l&&Object(P.c)(l)||null}}},{key:"_createFeatures",value:function(e,t){var r=new V(e,this.featureAdapter,this.fieldsIndex),n=this.hasM,a=this.hasZ,s=e.orderByFields,u=e.quantizationParameters,c=e.returnGeometry,o=e.returnCentroid,l=e.maxAllowableOffset,f=e.resultOffset,h=e.resultRecordCount,p=e.returnZ,d=void 0!==p&&p,m=e.returnM,v=a&&d,y=n&&(void 0!==m&&m),b=[],x=0,g=Object(j.a)(t);if(this._sortFeatures(g,s,(function(e,t,n){return r.getFieldValue(e,t,n)})),c||o){var O=Object(P.c)(u);if(c&&!o){var _,I=Object(i.a)(g);try{for(I.s();!(_=I.n()).done;){var w=_.value;b[x++]={attributes:r.getAttributes(w),geometry:Object(G.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(w),l,O,v,y)}}}catch(q){I.e(q)}finally{I.f()}}else if(!c&&o){var S,k=Object(i.a)(g);try{for(k.s();!(S=k.n()).done;){var F=S.value;b[x++]={attributes:r.getAttributes(F),centroid:Object(G.f)(this,this.featureAdapter.getCentroid(F,this),O)}}}catch(q){k.e(q)}finally{k.f()}}else{var R,M=Object(i.a)(g);try{for(M.s();!(R=M.n()).done;){var T=R.value;b[x++]={attributes:r.getAttributes(T),centroid:Object(G.f)(this,this.featureAdapter.getCentroid(T,this),O),geometry:Object(G.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(T),l,O,v,y)}}}catch(q){M.e(q)}finally{M.f()}}}else{var A,N=Object(i.a)(g);try{for(N.s();!(A=N.n()).done;){var Q=A.value,E=r.getAttributes(Q);E&&(b[x++]={attributes:E})}}catch(q){N.e(q)}finally{N.f()}}var z=f||0;if(null!=h){var C=z+h;b=b.slice(z,Math.min(b.length,C))}return b}},{key:"_createExceedsLimitQueryResponse",value:function(e){var t,r=!1,n=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,u=Object(i.a)(e.outStatistics);try{for(u.s();!(t=u.n()).done;){var c=t.value;if("exceedslimit"===c.statisticType){n=null!=c.maxPointCount?c.maxPointCount:Number.POSITIVE_INFINITY,a=null!=c.maxRecordCount?c.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=c.maxVertexCount?c.maxVertexCount:Number.POSITIVE_INFINITY;break}}}catch(f){u.e(f)}finally{u.f()}if("esriGeometryPoint"===this.geometryType)r=this.items.length>n;else if(this.items.length>a)r=!0;else{var o=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;r=this.items.reduce((function(e,t){var r=l.getGeometry(t);return e+(r&&r.coords.length||0)}),0)/o>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(r)}}]}}},{key:"_createStatisticsQueryResponse",value:function(e){var t,r=this,n={attributes:{}},a=[],s=new Map,u=new Map,c=new Map,o=new Map,l=new V(e,this.featureAdapter,this.fieldsIndex),f=e.outStatistics,h=e.groupByFieldsForStatistics,p=e.having,d=e.orderByFields,m=h&&h.length,v=!!m,y=v&&h[0],b=v&&!this.fieldsIndex.get(y),x=Object(i.a)(f);try{for(x.s();!(t=x.n()).done;){var g=t.value,j=g.outStatisticFieldName,O=g.statisticType,_=g,I="exceedslimit"!==O?g.onStatisticField:void 0,w="percentile_disc"===O||"percentile_cont"===O,S=v&&1===m&&(I===y||b)&&"count"===O;if(v){if(!c.has(I)){var k,F=[],R=Object(i.a)(h);try{for(R.s();!(k=R.n()).done;){var M=k.value,T=this._getAttributeValues(l,M,s);F.push(T)}}catch(z){R.e(z)}finally{R.f()}c.set(I,this._calculateUniqueValues(F,l.returnDistinctValues))}var A=c.get(I),N=function(e){var t=A[e],n=t.count,i=t.data,a=t.items,u=t.itemPositions,c=i.join(",");if(!p||l.validateItems(a,p)){var f=o.get(c)||{attributes:{}},d=null;if(S)d=n;else{var m=r._getAttributeValues(l,I,s),v=u.map((function(e){return m[e]}));d=w&&"statisticParameters"in _?r._getPercentileValue(_,v):r._getStatisticValue(_,v)}f.attributes[j]=d,h.forEach((function(e,t){return f.attributes[r.fieldsIndex.get(e)?e:"EXPR_".concat(t+1)]=i[t]})),o.set(c,f)}};for(var Q in A)N(Q)}else{var P=this._getAttributeValues(l,I,s);n.attributes[j]=w&&"statisticParameters"in _?this._getPercentileValue(_,P):this._getStatisticValue(_,P,u)}a.push({name:j,alias:j,type:"esriFieldTypeDouble"})}}catch(z){x.e(z)}finally{x.f()}var E=v?Array.from(o.values()):[n];return this._sortFeatures(E,d,(function(e,t){return e.attributes[t]})),{fields:a,features:E}}},{key:"_getStatisticValue",value:function(e,t,r){var n,i=e.onStatisticField,a=e.statisticType;return n=null!=r&&r.has(i)?r.get(i):Object(q.q)(this.fieldsIndex.get(i))?Object(z.b)({values:t}):Object(z.a)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),r&&r.set(i,n),n["var"===a?"variance":a]}},{key:"_getPercentileValue",value:function(e,t){var r=e.onStatisticField,n=e.statisticParameters,i=e.statisticType,a=n.value,s="desc"===n.orderBy,u=this.fieldsIndex.get(r),c=Object(j.a)(t).filter((function(e){return null!=e})).sort((function(e,t){return L(e,t,u,s)}));return this._calculatePercentile(c,a,"percentile_disc"===i)}},{key:"_getAttributeValues",value:function(e,t,r){if(r.has(t))return r.get(t);var n=this.fieldsIndex.get(t),i=this.items.map((function(r){return e.getFieldValue(r,t,n)}));return r.set(t,i),i}},{key:"_getAttributeNormalizedValues",value:function(e,t){var r=this;return this.items.map((function(n){return e.getNormalizedValue(n,{field:t.field,fieldInfo:r.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:r.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})}))}},{key:"_getAttributeExpressionValues",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r,n){var i,a,u,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(D.e)();case 2:return i=e.sent,a=i.arcadeUtils,u=a.createFunction(r),c=n&&a.getViewInfo(n),e.abrupt("return",this.items.map((function(e){return t.getExpressionValue(e,{compiledFunc:u,viewInfo:c},a)})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_calculateUniqueValues",value:function(e,t){for(var r={},n=this.items,a=n.length,s=0;s<a;s++){var u,c=n[s],o=[],l=Object(i.a)(e);try{for(l.s();!(u=l.n()).done;){var f=u.value;o.push(f[s])}}catch(p){l.e(p)}finally{l.f()}var h=o.join(",");t?null==r[h]&&(r[h]={count:1,data:o,items:[c],itemPositions:[s]}):null==r[h]?r[h]={count:1,data:o,items:[c],itemPositions:[s]}:(r[h].count++,r[h].items.push(c),r[h].itemPositions.push(s))}return r}},{key:"_calculatePercentile",value:function(e,t,r){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];var n=(e.length-1)*t,i=Math.floor(n),a=i+1,s=n%1,u=e[i],c=e[a];return a>=e.length||r||"string"==typeof u||"string"==typeof c?u:u*(1-s)+c*s}}]),e}(),H=r(949),W=r(366),X=r(518),$=(r(320),null);function K(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(u.a)(s.a.mark((function e(t){var r,n,i,a,u,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.field,n=t.normalizationField,i=t.valueExpression,a=[],!i){e.next=10;break}if($){e.next=9;break}return e.next=6,Object(D.e)();case 6:u=e.sent,c=u.arcadeUtils,$=c;case 9:a=$.extractFieldNames(i);case 10:return e.abrupt("return",(r&&a.push(r),n&&a.push(n),a));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var te="feature-store:unsupported-query",re=new Set,ne=new p.b(2e6),ie=0,ae=function(){function e(t){var r=this;Object(o.a)(this,e),this.capabilities={query:Q.a},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(function(){return r.clearCache()})),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new p.a(ie+++"$$",ne)),this.fieldsIndex=new W.a(t.fields),t.scheduler&&t.priority&&(this._frameQueue=new X.a,this._frameTask=t.scheduler.registerTask(t.priority,this))}return Object(c.a)(e,[{key:"destroy",value:function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}},{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:Object(G.b)(this.spatialReference)}:null}},{key:"timeExtent",get:function(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(C.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}},{key:"clearCache",value:function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}},{key:"executeQuery",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,i,a=this,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,i=Object(f.a)(t),e.prev=3,e.next=6,this._schedule((function(){return Object(G.d)(i,a.definitionExpression,a.spatialReference)}),r);case 6:return i=e.sent,e.next=9,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 9:return i=e.sent,e.next=12,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 12:return n=e.sent,e.next=15,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 15:return n=e.sent,e.next=18,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 18:return n=e.sent,e.next=21,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 21:return n=e.sent,e.next=24,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 24:n=e.sent,e.next=32;break;case 27:if(e.prev=27,e.t0=e.catch(3),e.t0===G.a){e.next=31;break}throw e.t0;case 31:n=new J([],null,this);case 32:return e.abrupt("return",n.createQueryResponse(i));case 33:case"end":return e.stop()}}),e,this,[[3,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForCount",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,i,a=this,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,(i=Object(f.a)(t)).returnGeometry=!1,i.returnCentroid=!1,i.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return Object(G.d)(i,a.definitionExpression,a.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 10:return i=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 13:return n=e.sent,e.next=16,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 25:n=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(4),e.t0===G.a){e.next=32;break}throw e.t0;case 32:return e.abrupt("return",0);case 33:return e.abrupt("return",n.createQueryResponseForCount(i));case 34:case"end":return e.stop()}}),e,this,[[4,28]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForExtent",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,i,a,u,c,o,l,h,p,v=this,y=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=y.length>0&&void 0!==y[0]?y[0]:{},r=y.length>1?y[1]:void 0,i=Object(f.a)(t),a=i.outSR,e.prev=4,e.next=7,this._schedule((function(){return Object(G.d)(i,v.definitionExpression,v.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return v._checkQuerySupport(i)}),r);case 10:return(i=e.sent).returnGeometry=!0,i.returnCentroid=!1,i.outSR=null,e.next=16,this._reschedule((function(){return v._executeGeometryQuery(i,r)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 25:return n=e.sent,e.next=28,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 28:if(n=e.sent,u=n.size){e.next=32;break}return e.abrupt("return",{count:u,extent:null});case 32:return Object(m.o)(ue,m.a),this.featureStore.forEachBounds(n.items,(function(e){return Object(m.f)(ue,e)}),se),c={xmin:ue[0],ymin:ue[1],xmax:ue[3],ymax:ue[4],spatialReference:Object(G.b)(this.spatialReference)},this.hasZ&&isFinite(ue[2])&&isFinite(ue[5])&&(c.zmin=ue[2],c.zmax=ue[5]),(o=Object(N.b)(c,n.spatialReference,a)).spatialReference=Object(G.b)(a||this.spatialReference),o.xmax-o.xmin==0&&(l=Object(d.f)(o.spatialReference),o.xmin-=l,o.xmax+=l),o.ymax-o.ymin==0&&(h=Object(d.f)(o.spatialReference),o.ymin-=h,o.ymax+=h),this.hasZ&&null!=o.zmin&&null!=o.zmax&&o.zmax-o.zmin==0&&(p=Object(d.f)(o.spatialReference),o.zmin-=p,o.zmax+=p),e.abrupt("return",{count:u,extent:o});case 42:if(e.prev=42,e.t0=e.catch(4),e.t0!==G.a){e.next=46;break}return e.abrupt("return",{count:0,extent:null});case 46:throw e.t0;case 47:case"end":return e.stop()}}),e,this,[[4,42]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForIds",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1?n[1]:void 0,e.abrupt("return",this.executeQueryForIdSet(t,r).then((function(e){return Array.from(e)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForIdSet",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,a,u,c,o=this,l=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=l.length>1?l[1]:void 0,(a=Object(f.a)(t)).returnGeometry=!1,a.returnCentroid=!1,a.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return Object(G.d)(a,o.definitionExpression,o.spatialReference)}),r);case 7:return a=e.sent,e.next=10,this._reschedule((function(){return o._checkQuerySupport(a)}),r);case 10:return a=e.sent,e.next=13,this._reschedule((function(){return o._executeGeometryQuery(a,r)}),r);case 13:return n=e.sent,e.next=16,this._reschedule((function(){return n.executeAggregateIdsQuery(a)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeObjectIdsQuery(a)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeTimeQuery(a)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeAttributesQuery(a)}),r);case 25:return n=e.sent,u=n.items,c=new Set,e.next=29,this._reschedule((function(){var e,t=Object(i.a)(u);try{for(t.s();!(e=t.n()).done;){var r=e.value;c.add(n.featureAdapter.getObjectId(r))}}catch(a){t.e(a)}finally{t.f()}}),r);case 29:return e.abrupt("return",c);case 32:if(e.prev=32,e.t0=e.catch(4),e.t0!==G.a){e.next=36;break}return e.abrupt("return",new Set);case 36:throw e.t0;case 37:case"end":return e.stop()}}),e,this,[[4,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForSnapping",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){var i,a,u,c,o,l,f,p,d,m,v,y,j,O,_=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.point,a=t.distance,0!==t.types){e.next=3;break}return e.abrupt("return",{candidates:[]});case 3:return e.next=5,this._reschedule((function(){return _._checkQuerySupport(t.query)}),r);case 5:if(u=e.sent,c=!Object(g.c)(i.spatialReference,this.spatialReference),e.t0=c,!e.t0){e.next=11;break}return e.next=11,Object(N.a)(i.spatialReference,this.spatialReference);case 11:if(o="number"==typeof a?a:a.x,l="number"==typeof a?a:a.y,f={xmin:i.x-o,xmax:i.x+o,ymin:i.y-l,ymax:i.y+l,spatialReference:i.spatialReference},p=c?Object(N.b)(f,this.spatialReference):f){e.next=14;break}return e.abrupt("return",{candidates:[]});case 14:return e.next=16,Object(x.a)(Object(b.a)(i),null,{signal:r});case 16:return d=e.sent[0],e.next=19,Object(x.a)(Object(b.a)(p),null,{signal:r});case 19:if(m=e.sent[0],!Object(h.j)(d)&&!Object(h.j)(m)){e.next=22;break}return e.abrupt("return",{candidates:[]});case 22:return v=new J(this._searchFeatures(this._getQueryBBoxes(m.toJSON())),null,this),e.next=25,this._reschedule((function(){return v.executeObjectIdsQuery(u)}),r);case 25:return v=e.sent,e.next=28,this._reschedule((function(){return v.executeTimeQuery(u)}),r);case 28:return v=e.sent,e.next=31,this._reschedule((function(){return v.executeAttributesQuery(u)}),r);case 31:return v=e.sent,y=d.toJSON(),j=c?Object(N.b)(y,this.spatialReference):y,O=c?Math.max(p.xmax-p.xmin,p.ymax-p.ymin)/2:a,e.abrupt("return",v.createSnappingResponse(Object(n.a)(Object(n.a)({},t),{},{point:j,distance:O}),i.spatialReference));case 34:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForLatestObservations",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,i,a=this,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,this.timeInfo&&this.timeInfo.trackIdField){e.next=4;break}throw new l.a(te,"Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});case 4:return i=Object(f.a)(t),e.prev=5,e.next=8,this._schedule((function(){return Object(G.d)(i,a.definitionExpression,a.spatialReference)}),r);case 8:return i=e.sent,e.next=11,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 11:return i=e.sent,e.next=14,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 14:return n=e.sent,e.next=17,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 17:return n=e.sent,e.next=20,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 20:return n=e.sent,e.next=23,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 23:return n=e.sent,e.next=26,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 26:return n=e.sent,e.next=29,this._reschedule((function(){return n.filterLatest()}),r);case 29:n=e.sent,e.next=37;break;case 32:if(e.prev=32,e.t0=e.catch(5),e.t0===G.a){e.next=36;break}throw e.t0;case 36:n=new J([],null,this);case 37:return e.abrupt("return",n.createQueryResponse(i));case 38:case"end":return e.stop()}}),e,this,[[5,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForSummaryStatistics",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,r,n,i,a=this,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,n=u.length>2?u[2]:void 0,t=Object(f.a)(t),e.prev=4,e.next=7,this._schedule((function(){return Object(G.d)(t,a.definitionExpression,a.spatialReference)}),n);case 7:return t=e.sent,e.next=10,this._reschedule((function(){return a._checkSummaryStatisticsSupport(t,r)}),n);case 10:return t=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(t,n)}),n);case 13:return i=e.sent,e.next=16,this._reschedule((function(){return i.executeAggregateIdsQuery(t)}),n);case 16:return i=e.sent,e.next=19,this._reschedule((function(){return i.executeObjectIdsQuery(t)}),n);case 19:return i=e.sent,e.next=22,this._reschedule((function(){return i.executeTimeQuery(t)}),n);case 22:return i=e.sent,e.next=25,this._reschedule((function(){return i.executeAttributesQuery(t)}),n);case 25:i=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(4),e.t0===G.a){e.next=32;break}throw e.t0;case 32:i=new J([],null,this);case 33:return e.abrupt("return",i.createSummaryStatisticsResponse(t,r));case 34:case"end":return e.stop()}}),e,this,[[4,28]])})));return function(){return e.apply(this,arguments)}}()},{key:"_schedule",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._frameQueue?this._frameQueue.push(t,r):t());case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_reschedule",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._frameQueue?this._frameQueue.unshift(t,r):t());case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"running",get:function(){return this._frameQueue.length>0}},{key:"runTask",value:function(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null}},{key:"_getAll",value:function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new J(e,null,this)}return this._allItems}},{key:"_executeGeometryQuery",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){var n,a,c,o,l,f,p,d,m,v,y,b,x,j,O,_,I,w,S,k,F,R,M=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.geometry,a=t.outSR,c=t.spatialRel,o=t.returnGeometry,l=t.returnCentroid,f=o||l,p=Object(g.j)(a)&&!Object(g.c)(this.spatialReference,a),!(d=this._geometryQueryCache?p&&f?JSON.stringify({geometry:n,spatialRelationship:c,outSpatialReference:a}):JSON.stringify({geometry:n,spatialRelationship:c}):null)){e.next=5;break}if(m=this._geometryQueryCache.get(d),Object(h.l)(m)){e.next=5;break}return e.abrupt("return",m);case 5:if(v=function(){var e=Object(u.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p||!f){e.next=5;break}return e.next=3,t.project(a);case 3:return r=e.sent,e.abrupt("return",(d&&M._geometryQueryCache.put(d,r,r.size||1),r));case 5:return e.abrupt("return",(d&&M._geometryQueryCache.put(d,t,t.size||1),t));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n){e.next=8;break}return e.abrupt("return",v(this._getAll()));case 8:if(y=this.featureAdapter,"esriSpatialRelDisjoint"!==c){e.next=23;break}if((b=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=13;break}return e.abrupt("return",v(this._getAll()));case 13:O=new Set,_=Object(i.a)(b);try{for(_.s();!(I=_.n()).done;)w=I.value,O.add(y.getObjectId(w))}catch(T){_.e(T)}finally{_.f()}return e.next=18,this._reschedule((function(){var e=0;x=new Array(O.size),M.featureStore.forEach((function(t){return x[e++]=t})),j=O}),r);case 18:return e.t0=v,e.next=21,this._reschedule(Object(u.a)(s.a.mark((function e(){var t,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(H.c)(c,n,M.geometryType,M.hasZ,M.hasM);case 2:return t=e.sent,i=function(e){return!j.has(y.getObjectId(e))||t(y.getGeometry(e))},e.t0=J,e.next=7,M._runSpatialFilter(x,i,r);case 7:return e.t1=e.sent,e.t2=n,e.t3=M,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3));case 11:case"end":return e.stop()}}),e)}))),r);case 21:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 23:if((S=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=27;break}return k=new J([],n,this),e.abrupt("return",(d&&this._geometryQueryCache.put(d,k,k.size||1),k));case 27:if(!this._canExecuteSoloPass(n,t)){e.next=29;break}return e.abrupt("return",v(new J(S,n,this)));case 29:return e.next=31,Object(H.c)(c,n,this.geometryType,this.hasZ,this.hasM);case 31:return F=e.sent,e.next=34,this._runSpatialFilter(S,(function(e){return F(y.getGeometry(e))}),r);case 34:return R=e.sent,e.abrupt("return",v(new J(R,n,this)));case 36:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_runSpatialFilter",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r,n){var i,a,c,o=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",t);case 2:if(this._budget){e.next=4;break}return e.abrupt("return",t.filter((function(e){return r(e)})));case 4:return i=0,a=new Array,c=function(){var e=Object(u.a)(s.a.mark((function e(){var u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<t.length)){e.next=10;break}if(u=t[i],r(u)&&a.push(u),e.t0=o._budget.done,!e.t0){e.next=7;break}return e.next=7,o._reschedule((function(){return c()}),n);case 7:++i;case 8:e.next=0;break;case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",this._reschedule((function(){return c()}),n).then((function(){return a})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_canExecuteSoloPass",value:function(e,t){var r=this.geometryType,n=t.spatialRel;return Object(H.a)(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}},{key:"_getQueryBBoxes",value:function(e){if(Object(H.a)(e)){if(Object(b.d)(e))return[Object(v.m)(e.xmin,e.ymin,e.xmax,e.ymax)];if(Object(b.g)(e))return e.rings.map((function(e){return Object(v.m)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[Object(y.a)(Object(v.h)(),e)]}},{key:"_searchFeatures",value:function(e){var t,r=Object(i.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.featureStore.forEachInBounds(n,(function(e){re.add(e)}))}}catch(u){r.e(u)}finally{r.f()}var a=new Array(re.size),s=0;return re.forEach((function(e){return a[s++]=e})),re.clear(),a}},{key:"_checkSummaryStatisticsSupport",value:function(){var e=Object(u.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)){e.next=2;break}throw new l.a(te,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkSummaryStatisticsParamsSupport(r),Object(H.b)(t,this.geometryType,this.spatialReference),Object(N.a)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_checkSummaryStatisticsParamsSupport",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K({field:t.field,normalizationField:t.normalizationField,valueExpression:t.valueExpression});case 2:if((r=e.sent).length){e.next=5;break}throw new l.a(te,"params should have atleast a field or valueExpression",{params:t});case 5:M(this.fieldsIndex,r,"params contains missing fields");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_checkQuerySupport",value:function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)){e.next=2;break}throw new l.a(te,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),Object(H.b)(t,this.geometryType,this.spatialReference),Object(N.a)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_checkAttributesQuerySupport",value:function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues,i=e.outStatistics,a=i?i.map((function(e){return e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()})):[];if(r&&r.length>0){var s=" asc",u=" desc",c=r.map((function(e){var t=e.toLowerCase();return t.indexOf(s)>-1?t.split(s)[0]:t.indexOf(u)>-1?t.split(u)[0]:e})).filter((function(e){return-1===a.indexOf(e)}));M(this.fieldsIndex,c,"orderByFields contains missing fields")}if(t&&t.length>0)M(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new l.a(te,"outFields should be specified for returnDistinctValues",{query:e});!function(e,t){if(!t)return!0;var r=I.get(t,e);if(!r)throw new l.a(w,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new l.a(w,"where clause is not standard",{where:t});M(e,r.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,e.where)}},{key:"_checkStatisticsQuerySupport",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var r,n,a,u,c,o,f,h,p,d,m;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.outStatistics,n=t.groupByFieldsForStatistics,a=t.having,u=n&&n.length,c=r&&r.length,!a){e.next=5;break}if(u&&c){e.next=4;break}throw new l.a(te,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});case 4:F(this.fieldsIndex,a,r);case 5:if(!c){e.next=34;break}if(r.every((function(e){return"exceedslimit"!==e.statisticType}))){e.next=8;break}return e.abrupt("return");case 8:o=r.map((function(e){return e.onStatisticField})),M(this.fieldsIndex,o,"onStatisticFields contains missing fields"),u&&M(this.fieldsIndex,n,"groupByFieldsForStatistics contains missing fields"),f=Object(i.a)(r),e.prev=11,f.s();case 13:if((h=f.n()).done){e.next=26;break}if(p=h.value,d=p.onStatisticField,"percentile_disc"!==(m=p.statisticType)&&"percentile_cont"!==m||!("statisticParameters"in p)){e.next=22;break}if(p.statisticParameters){e.next=20;break}throw new l.a(te,"statisticParamters should be set for percentile type",{definition:p,query:t});case 20:e.next=24;break;case 22:if("count"===m||!d||!A(d,this.fieldsIndex)){e.next=24;break}throw new l.a(te,"outStatistics contains non-numeric fields",{definition:p,query:t});case 24:e.next=13;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(11),f.e(e.t0);case 31:return e.prev=31,f.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[11,28,31,34]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),se=Object(m.c)(),ue=Object(m.c)();t.a=ae},842:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return u}));var n=r(15);r(22),r(10),r(70);function i(e){var t=null!=e.normalizationField||null!=e.normalizationType,r=null!=e.minValue||null!=e.maxValue,n=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!r&&!n}function a(e){var t=e.values,r=e.supportsNullCount,n=t.filter((function(e){return null!=e})).length,i={count:n};return r&&(i.nullcount=t.length-n),i}function s(e){var t,r=e.values,i=e.useSampleStdDev,a=e.supportsNullCount,s=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,c=null,o=null,l=null,f=null,h=0,p=null==e.minValue?-1/0:e.minValue,d=null==e.maxValue?1/0:e.maxValue,m=Object(n.a)(r);try{for(m.s();!(t=m.n()).done;){var v=t.value;Number.isFinite(v)?v>=p&&v<=d&&(c+=v,s=Math.min(s,v),u=Math.max(u,v),h++):"string"==typeof v&&h++}}catch(O){m.e(O)}finally{m.f()}if(h&&null!=c){o=c/h;var y,b=0,x=Object(n.a)(r);try{for(x.s();!(y=x.n()).done;){var g=y.value;Number.isFinite(g)&&g>=p&&g<=d&&(b+=Math.pow(g-o,2))}}catch(O){x.e(O)}finally{x.f()}f=i?h>1?b/(h-1):0:h>0?b/h:0,l=Math.sqrt(f)}else s=null,u=null;var j={avg:o,count:h,max:u,min:s,stddev:l,sum:c,variance:f};return a&&(j.nullcount=r.length-h),j}function u(e,t){return t?(["avg","stddev","variance"].forEach((function(t){null!=e[t]&&(e[t]=Math.ceil(e[t]))})),e):e}function c(e,t,r,n){var i=null;switch(t){case"log":0!==e&&(i=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(n)&&0!==n&&(i=e/n*100);break;case"field":Number.isFinite(r)&&0!==r&&(i=e/r);break;case"natural-log":e>0&&(i=Math.log(e));break;case"square-root":e>0&&(i=Math.pow(e,.5))}return i}},843:function(e,t,r){"use strict";function n(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach((function(e){var t=r.getAttribute(e,n),u=r.getAttribute(e,i);null==t||isNaN(t)||(a=Math.min(a,t)),null==u||isNaN(u)||(s=Math.max(s,u))}));else{var u=n||i;t.forEach((function(e){var t=r.getAttribute(e,u);null==t||isNaN(t)||(a=Math.min(a,t),s=Math.max(s,t))}))}return{start:a,end:s}}function i(e,t,r){if(!t||!e)return null;var n=e.startTimeField,i=e.endTimeField;if(!n&&!i)return null;var a=t.start,s=t.end;return null===a&&null===s?null:void 0===a&&void 0===s?function(){return!1}:n&&i?function(e,t,r,n,i){return null!=n&&null!=i?function(a){var s=e.getAttribute(a,t),u=e.getAttribute(a,r);return(null==s||s<=i)&&(null==u||u>=n)}:null!=n?function(t){var i=e.getAttribute(t,r);return null==i||i>=n}:null!=i?function(r){var n=e.getAttribute(r,t);return null==n||n<=i}:void 0}(r,n,i,a,s):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){var a=e.getAttribute(i,t);return a>=r&&a<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(r,n||i,a,s)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}))},949:function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return F})),r.d(t,"c",(function(){return k}));var n=r(8),i=r.n(n),a=r(15),s=r(14),u=r(22),c=r(118),o=r(364);var l=r(82),f=r(45);function h(e,t){return e?t?4:3:t?3:2}function p(e,t,r,n,i){if(!e)return!1;var s,u=h(t,r),c=e.coords,o=e.lengths,l=!1,f=0,p=Object(a.a)(o);try{for(p.s();!(s=p.n()).done;){var m=s.value;l=d(l,c,u,f,m,n,i),f+=m*u}}catch(v){p.e(v)}finally{p.f()}return l}function d(e,t,r,n,i,a,s){for(var u=e,c=n,o=n,l=n+i*r;o<l;o+=r){(c=o+r)===l&&(c=n);var f=t[o],h=t[o+1],p=t[c],d=t[c+1];(h<s&&d>=s||d<s&&h>=s)&&f+(s-h)/(d-h)*(p-f)<a&&(u=!u)}return u}var m=r(439),v=r(154),y=r(619),b=r(771),x="feature-store:unsupported-query",g={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},j={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},O={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},_={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function I(e){return!0===j[e]}function w(e){return!0===O[Object(l.c)(e)]}function S(e){return!0===_[e]}function k(e,t,n,i,a){if(Object(l.g)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var s=Object(m.g)(new v.a,t,!1,!1);return Promise.resolve((function(e){return function(e,t,r,n){return p(e,t,r,n.coords[0],n.coords[1])}(s,!1,!1,e)}))}if(Object(l.g)(t)&&"esriGeometryMultipoint"===n){var u=Object(m.g)(new v.a,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((function(e){return function(e,t,r,n,i,a){var s=h(i,a),u=n.coords,c=n.lengths;if(!c)return!1;for(var o=0,l=0;o<c.length;o++,l+=s)if(!p(e,t,r,u[l],u[l+1]))return!1;return!0}(u,!1,!1,e,i,a)}))}if(Object(l.d)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((function(e){return Object(c.e)(t,Object(b.c)(n,i,a,e))}));if(Object(l.d)(t)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===e)return Promise.resolve((function(e){return Object(c.d)(t,Object(b.c)(n,i,a,e))}));if(Object(l.d)(t)&&"esriSpatialRelIntersects"===e){var f=function(e){return"mesh"===e?o.a:Object(o.c)(e)}(n);return Promise.resolve((function(e){return f(t,Object(b.c)(n,i,a,e))}))}return Promise.all([r.e(5),r.e(21)]).then(r.bind(null,827)).then((function(r){var s=r[g[e]].bind(null,t.spatialReference,t);return function(e){return s(Object(b.c)(n,i,a,e))}}))}function F(e,t,r){return R.apply(this,arguments)}function R(){return(R=Object(s.a)(i.a.mark((function e(t,r,n){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.spatialRel,!(s=t.geometry)){e.next=11;break}if(I(a)){e.next=4;break}throw new u.a(x,"Unsupported query spatial relationship",{query:t});case 4:if(!Object(f.j)(s.spatialReference)||!Object(f.j)(n)){e.next=11;break}if(w(s)){e.next=7;break}throw new u.a(x,"Unsupported query geometry type",{query:t});case 7:if(S(r)){e.next=9;break}throw new u.a(x,"Unsupported layer geometry type",{query:t});case 9:if(!t.outSR){e.next=11;break}return e.abrupt("return",Object(y.a)(t.geometry&&t.geometry.spatialReference,t.outSR));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){if(Object(l.d)(e))return!0;if(Object(l.g)(e)){var t,r=Object(a.a)(e.rings);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(5!==n.length)return!1;if(n[0][0]!==n[1][0]||n[0][0]!==n[4][0]||n[2][0]!==n[3][0]||n[0][1]!==n[3][1]||n[0][1]!==n[4][1]||n[1][1]!==n[2][1])return!1}}catch(i){r.e(i)}finally{r.f()}return!0}return!1}}}]);
//# sourceMappingURL=7.9f3f25be.chunk.js.map